<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <title>Reconocimiento</title>
  <!--Let browser know website is optimized for mobile-->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <!-- Compiled and minified CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/css/materialize.min.css">
  <!-- Compiled and minified JavaScript -->
  <link href="https://fonts.googleapis.com/css?family=Raleway|Roboto" rel="stylesheet">
  <!--  Materialize Scripts-->
  <!--  SweetAleert2-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/6.9.1/sweetalert2.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/6.9.1/sweetalert2.min.css">
  <!-- Include a polyfill for ES6 Promises (optional) for IE11 and Android browser -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/core-js/2.4.1/core.js"></script>
  <!-- First, include the Webcam.js JavaScript Library -->
  <script type="text/javascript" src="webcam.js"></script>
  <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/js/materialize.min.js"></script>
  <script src="js/init.js"></script>
  <script async defer src="https://buttons.github.io/buttons.js"></script>
</head>
<body>
  <div class="navbar-fixed">
    <nav class="white" role="navigation">
      <div class="nav-wrapper container">
        <ul id="slide-out" class="side-nav">
          <li><a href=".">Home</a></li>
          <li><a href="captura.html">Captura</a></li>
          <li><a href="reconocimiento.html">Reconocimiento Facial</a></li>
        </ul>
        <a href="#" data-activates="slide-out" class="button-collapse show-on-large"><i class="material-icons">menu</i></a>
        <a id="logo-container" href="." class="brand-logo">RF</a>
        <ul class="right hide-on-med-and-down">
          <li><a href="captura.html">Captura</a></li>
          <li class="active"><a href="reconocimiento.html">Reconocimiento</a></li>
        </ul>
        <ul id="nav-mobile" class="side-nav">
          <li><a href="captura.html">Captura</a></li>
          <li class="active"><a href="reconocimiento.html">Reconocimiento</a></li>
        </ul>
      </div>
    </nav>
    </div>
	<div id="carga" class="progress" style="display:none">
		<div  class="indeterminate"></div>
  	</div>
	<section class="aboutContent">
		<div class="container">
			<h1 class="responsive center">Módulo</h1>
			<p>A continuación podrá identificar su identidad con solo tomar una foto, para lograr esto es necesario que se haya registrado anteriormente con un correo y se haya detectado su rostro de forma satisfactoria. A continuación por favor ingrese su correo electronico, luego seleccione una pose con la cual se va a tomar la foto y por ultimo de click al botón "ingresar".</p>
		</div>
	</section>
	<section>
		<div class="container row">
			<div id="my_camera" class="responsive-video col s12 m6 l6">
				<script language="JavaScript">
					Webcam.set({
						width: 300,
						height: 230,
						dest_width: 600,
						dest_height: 460,
						image_format: 'jpeg',
						jpeg_quality: 100,
             flip_horiz: true,
					});
					Webcam.attach( '#my_camera' );
				</script>
          </div>
			 <div class="col s12 m6 l6">
         <h2 class="center teal-text">
           <i id="c3" class="material-icons large" style="display:none">filter_3</i>
            <i id="c2" class="material-icons large" style="display:none">filter_2</i>
            <i id="c1" class="material-icons large" style="display:none">mood</i>
         </h2>
        </div> 
		</div>
	</section>
	<section class="inquiry">
		<div class="container row">
			<form id="myform" name="Form" method="post" action="comparelogin.php">
				<h2>Ingreso</h2>
				<div class="row">
					<div class="input-field col s12 m6 l6">
						<input name="nombre_img" id="email" type="email" required onkeydown="if (event.keyCode == 13) return false" />
						<label for="email">Email</label>
					</div>
          <div class="input-field col s12 m6 l6">
                <select id="pose" name="pose">
                    <option value="" disabled selected>Elije una pose</option>
                    <option value="izquierda">Mirar a la izquierda</option>
                    <option value="derecha">Mirar a la derecha</option>
                    <option value="arriba">Mirar arriba</option>
                    <option value="abajo">Mirar abajo</option>
                </select>
                <label>Pose</label>
            </div>
             <div class="input-field col s12 m12 l12">
            <p>
              <input type="checkbox" id="ojos" name="ojos" value="ojos"/>
              <label for="ojos">Ojos abiertos</label>
            </p>
            <p>
              <input type="checkbox" id="boca" name="boca" value="boca"/>
              <label for="boca">Boca abierta</label>
              <br>
            </p>
             </div>
				</div>
        <section>
				<div class="row">
					<div class="col s12 m4">
						<button id="boton" class="btn red waves-effect waves-light" type="button"  onClick="take_snapshot1()">Ingresar
							<i class="material-icons right">photo_camera</i>
						</button>
					</div>
				</div>
        </section>
				<input id="mydata" type="hidden" name="mydata" value=""/>
			</form>
		</div>
	</section>
    <footer class="page-footer teal">
    <div class="container">
      <div class="row">
        <div class="col l6 s12">
          <h5 class="white-text">Sobre nosotros</h5>
          <p class="grey-text text-lighten-4">Somos estudiantes de último semestre de ingeniería de sistemas de la universidad Industrial de Santander, actualmente estamos desarrollando nuestro proyecto orientado en métodos de autenticación biométrica.</p>


        </div>
        <div class="col l3 s12">
          <h5 class="white-text">Desarrollado con</h5>
          <ul>
            <li><a class="white-text" href="https://aws.amazon.com/es/rekognition/">Amazon Rekognition</a></li>
            <li><a class="white-text" href="http://materializecss.com/">Materializecss</a></li>
            <li><a class="white-text" href="https://limonte.github.io/sweetalert2/">SweetAlert2</a></li>
          </ul>
        </div>
        <div class="col l3 s12">
          <h5 class="white-text">Repositorios</h5>
          <ul>
            <li><a class="github-button" href="https://github.com/davidjurado/ReconocimientoFacial" data-size="large" aria-label="Star davidjurado/ReconocimientoFacial on GitHub">ReconocimientoFacial</a></li>
            <li><a class="github-button" href="https://github.com/julian1303/ReconocimientoVocal" data-size="large" aria-label="Star julian1303/ReconocimientoVocal on GitHub">ReconocimientoVocal</a></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="footer-copyright">
      <div class="container">
      &copy;2017 Universidad Industrial de Santander
      </div>
    </div>
  </footer>
</body>
</html>


<script type="text/javascript">
    $(document).ready(function() {
        $('select').material_select();
    });
</script>
<script type="text/javascript">
	function validarEmail( email ) {
		expr = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
			if ( !expr.test(email) )
				{
    				swal({
    					title: 'Error!',
    					text: 'Debe ingresar un correo electronico valido',
    					type: 'error',
    					confirmButtonText: 'Ok'
    				})
    				return false;
    			}
    			else
    			{
    				return true;
    			}
    		}
</script>
<script type="text/javascript">
	function validateForm()
	{
		var a=document.forms["Form"]["nombre_img"].value;
    var b=document.forms["Form"]["pose"].value;
		if (a==null || a=="" || b=="")
		{
			swal({
				title: 'Error!',
				text: 'Debe ingresar todos los campos',
				type: 'error',
				confirmButtonText: 'Ok'
			})
			return false;
		}
		else
		{
			return true;
		}
	}
</script>
<script language="JavaScript">
	function take_snapshot1() {
		if(validateForm()!=false && validarEmail(document.forms["Form"]["nombre_img"].value)!=false){
      document.getElementById('boton').disabled = true;
      var cameraSound = new Audio('media/camera.wav');
      var beepSound = new Audio('media/beep.wav');
      setTimeout(function(){beepSound.play();
      document.getElementById('c3').style.display = 'block';
      },1);
      setTimeout(function(){beepSound.play();
      document.getElementById('c2').style.display = 'block';
      document.getElementById('c3').style.display = 'none';
      },1000);
      setTimeout(function(){beepSound.play();
       document.getElementById('c1').style.display = 'block';
      document.getElementById('c2').style.display = 'none';
      },2000);
      setTimeout(function(){cameraSound.play();},3000);
  
      setTimeout(function(){

      document.getElementById('carga').style.display = 'block';
      swal({
        title: 'Cargando',
        text: 'Tu imagen se esta cargando',
        allowOutsideClick: false,
        onOpen: function () {
          swal.showLoading()
        }
      }).then(function () {},)
            Webcam.snap( function(data_uri) {
              var raw_image_data = data_uri.replace(/^data\:image\/\w+\;base64\,/, '');
              document.getElementById('mydata').value = raw_image_data;
              document.getElementById('myform').submit();
            } );

      },3000)


					}
				}
</script>